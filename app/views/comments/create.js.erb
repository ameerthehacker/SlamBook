<% comment_error_id = @comment.reply_to.nil? ? "slam-#{@slam.id}-comment-errors" : "slam-#{@slam.id}-comment-#{@comment.reply_to}-reply-errors" %>
<% comment_id = @comment.reply_to.nil? ? "slam-#{@slam.id}-comment" : "slam-#{@slam.id}-comment-#{@comment.reply_to}-reply" %>
<% comments_id = @comment.reply_to.nil? ? "slam-#{@slam.id}-comments" : "slam-#{@slam.id}-comment-#{@comment.reply_to}-replies" %>
<% if @comment.new_record? %>
    $('<%= "##{comment_error_id}" %>').html("<%= j render 'shared/errors', :obj => @comment %>");
<% else %>
    <% if @comment.reply_to.nil? %>
        $('<%= "##{comments_id}" %>').prepend("<%= j render @comment %>");        
    <% else %>
        $('<%= "##{comments_id}" %>').append("<%= j render @comment %>"); 
        $('<%= "##{comment_id}-form" %>').addClass("hidden");                       
    <% end %>
    $('<%= "##{comment_id}" %>').val("");
<% end %>